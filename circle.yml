dependencies:
  override:
    - npm prune
    - npm install
    - bower prune
    - bower install
  cache_directories:
    - node_modules
    - app/bower_components

machine:
  environment:
    NODE_ENV: test

test:
  override:
    - grunt test

deployment:
  try:
    branch: /try.*/
    commands:
      - git push -f git@heroku.com:gitflow2-tryout-try.git ${CIRCLE_SHA1}:refs/heads/master
  dev:
    branch: develop
    commands:
      - git push -f git@heroku.com:gitflow2-tryout-dev.git ${CIRCLE_SHA1}:refs/heads/master
  qa:
    branch: /release\/.+/
    commands:
      - git push -f git@heroku.com:gitflow2-tryout-qa.git ${CIRCLE_SHA1}:refs/heads/master
  client:
    branch: client
    commands:
      - git push -f git@heroku.com:gitflow2-tryout-client.git ${CIRCLE_SHA1}:refs/heads/master
  prod:
    branch: master
    commands:
      - git push -f git@heroku.com:gitflow2-tryout-prod.git ${CIRCLE_SHA1}:refs/heads/master

